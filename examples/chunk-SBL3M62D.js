var Ue=()=>{},St=String.fromCharCode,{from:Et,isArray:_e,of:wt}=Array,{MAX_VALUE:It,NEGATIVE_INFINITY:Tt,POSITIVE_INFINITY:xt,isFinite:Mt,isInteger:Ct,isNaN:Nt,parseFloat:At,parseInt:Vt}=Number,{random:Rt}=Math,{assign:W,defineProperty:Ft,entries:E,fromEntries:F,keys:Zt,getPrototypeOf:Ot,values:Pt}=Object,Be=Date.now,{iterator:qt,toStringTag:jt}=Symbol,{assert:zt,clear:Dt,debug:Lt,dir:Ut,error:ce,log:Bt,table:Ht}=console,{now:Gt}=performance,Y=e=>e.prototype,w=e=>typeof e=="function",f=(e,t,...s)=>r=>e[t].bind(r,...s),k=(e,t,...s)=>e[t].bind(e,...s),X=Y(Array),Z=Y(Map),O=Y(Set),He=f(X,"pop"),de=f(X,"push"),Ge=f(X,"splice",0),J=f(O,"add"),ue=f(O,"clear"),pe=f(O,"delete"),he=f(O,"has"),ge=f(Z,"clear"),P=f(Z,"delete"),T=f(Z,"get"),I=f(Z,"set"),Wt=Symbol(1),fe=Symbol(1),Yt=Symbol(1),We=(e,t)=>{let s=0;return(...r)=>{let a=Be();return a-s>e?(s=a,t(...r)):fe}},Ye=(e,t)=>e===t,ke=(e,t)=>!1,me=e=>e===!1?ke:e??Ye,Xe=(e,t)=>{let s=me(t),r=We(e,s);return(a,o)=>{let i=r(a,o);return i===fe?!0:i}},Je=e=>{let t=e.length**.5;return e.reduce((s,r)=>s+r*(r+t),0)},kt=Ue,K=e=>{let{newId:t,getId:s,setId:r,addEdge:a}=e;return class{constructor(o,{name:i,equals:d}={}){let u=t();r(u,this),this.id=u,this.rid=u,this.name=i,this.value=o,this.equals=me(d)}get(o){return o&&a(this.id,o),this.value}set(o){let i=this.value;return!this.equals(i,this.value=w(o)?o(i):o)}run(o){return o?1:0}bindMethod(o){return k(this,o)}static create(...o){let i=new this(...o);return[i.id,i]}}},Ke=e=>{let t=e.runId;return class extends e.getClass(K){constructor(s,r){super(s,r)}set(s){return super.set(s)?(t(this.id),!0):!1}static create(s,r){let a=new this(s,r);return[a.id,a.bindMethod("get"),a.bindMethod("set")]}}},Qe=e=>class extends e.getClass(K){constructor(t,s){super(s?.value,s),this.fn=t,s?.defer===!1&&this.get()}get(t){return this.rid&&(this.run(),this.rid=0),super.get(t)}run(t){return super.set(this.fn(this.rid))?1:0}static create(t,s){let r=new this(t,s);return[r.id,r.bindMethod("get")]}},$e=e=>{let t=e.runId;return class extends e.getClass(K){constructor(s,r){super(void 0,r),this.fn=s,r?.defer===!1&&this.set()}get(s){s&&(this.rid&&this.run(),super.get(s))}set(){return t(this.id)}run(s){let r=this.fn(this.rid)!==!1;return this.rid&&(this.rid=0),r?1:0}static create(s,r){let a=new this(s,r);return[a.id,a.bindMethod("get"),a.bindMethod("set")]}}},ye=class{addEdge;delEdge;newId;getId;setId;delId;runId;swapId;onInit;onDelete;clearCache;addClass;getClass;batch;dynamic;constructor(){let e=0,t=0,s=new Map,r=new Map,a=T(s),o=T(r),i=I(s),d=I(r),u=P(s),h=P(r),c=new Map,m=T(c),y=I(c),b=ge(c),L=n=>{let l=new Set,_=J(l),p=he(l),g=S=>{p(S)||(a(S)?.forEach(g),_(S))};return n.forEach(g),n.forEach(pe(l)),[...l,...n].reverse()},Ie=(...n)=>{let l=Je(n);return m(l)??(y(l,L(n))&&m(l))},U=new Map,v=T(U),B=I(U),Te=P(U),R=new Set,te=J(R),xe=pe(R),Me=ue(R),H=new Set,Ce=J(H),Ne=he(H),Ae=ue(H),se=new Map,bt=I(se),vt=ge(se),re=[],Ve=de(re),Re=He(re),ne=(...n)=>{Me(),Ae(),n.forEach(te);let l=n.length,_=Ie(...n);for(let g of _){if(xe(g)&&!Ne(g)){let S=Fe(g,l-- >0);S!==0&&a(g)?.forEach(S>=1?te:Ce)}if(R.size<=0)break}let p;for(;p=Re();)v(p)?.postrun()},Fe=(n,l)=>{let _=l===!0,p=v(n),g=p?.run(_)??0;return g>=1&&p.postrun&&Ve(n),g},ae=[],Ze=de(ae),Oe=Ge(ae),le=()=>++t,oe=()=>{--t<=0&&(t=0,ne(...Oe()))},Pe=(n,...l)=>{le();let _=n(...l);return oe(),_},G=new Map,qe=T(G),je=I(G),ze=P(G);this.onInit=(n,l)=>n?l():void 0,this.onDelete=(n,l)=>{n&&je(n,l)},this.addEdge=(n,l)=>{if(n+l<=0)return!1;let _=a(n)??(i(n,new Set)&&a(n));return _.has(l)?!1:(_.add(l),o(l)?.add(n)||d(l,new Set([n])),b(),!0)},this.delEdge=(n,l)=>a(n)?.delete(l)&&o(l)?.delete(n)?(b(),!0):!1,this.newId=()=>(b(),++e),this.getId=v,this.setId=B,this.delId=n=>{if(Te(n)){let l=a(n),_=o(n);return l?.forEach(p=>{o(p)?.delete(n)}),_?.forEach(p=>{a(p)?.delete(n)}),l?.clear(),_?.clear(),u(n),h(n),b(),qe(n)?.(),ze(n),!0}return!1},this.swapId=(n,l)=>{let _=v(n),p=v(l);B(n,p),B(l,_),_&&(_.id=l,_.rid&&(_.rid=l)),p&&(p.id=n,p.rid&&(p.rid=n)),b()},this.clearCache=b,this.runId=n=>t<=0?(ne(n),!0):(Ze(n),!1);let ie=new Map,De=T(ie),Le=I(ie);this.addClass=n=>{let l=this.getClass(n);return k(l,"create")},this.getClass=n=>{let l=De(n);return l||(l=n(this),Le(n,l),l)},this.batch={startBatching:le,endBatching:oe,scopedBatching:Pe},this.dynamic={setValue:(n,l)=>{let _=v(n??0);_&&(_.value=l)},setEquals:(n,l)=>{let _=v(n??0);_&&(_.equals=l)},setFn:(n,l)=>{let _=v(n??0);_&&(_.fn=l)}}}},et=globalThis.customElements,x=Symbol(1),M=Symbol(1),C=Symbol(1),q=Symbol(1),N=Symbol(1),j=Symbol(1),Q=e=>{let{[M]:t,[C]:s,[q]:r,[N]:a,[j]:o,[x]:i,...d}=e??{};return{[M]:t,[C]:s,[q]:r,[N]:a,[j]:o,[x]:{...d,...i}}},tt=e=>{let{[x]:t={},[M]:s={},[C]:r={},style:a,init:o,clean:i,...d}=e??{},u=F(E(d).filter(([h,c])=>{if(h.startsWith("on:"))s[h.slice(3)]=c;else if(h.startsWith("set:"))r[h.slice(4)]=c;else if(h.startsWith("attr:"))t[h.slice(5)]=c;else return!0}));return W(u,{[x]:t,[M]:s,[C]:r,[q]:a,[N]:o,[j]:i})},be=class{constructor(e){}bindMethod(e){return k(this,e)}},$=Symbol(1),st=Symbol(1),rt=Symbol(1),nt=e=>typeof e!="symbol",z=class extends be{zones=[];configs={};constructor(e){super(),this.setDefaultZone(...e?.default??[])}setDefaultZone(...e){this.zones[0]=e}pushZone(...e){return this.zones.push(e),st}popZone(){let e=this.zones;return e.length>1&&e.pop(),rt}seekZone(){return this.zones.at(-1)}test(e,t){for(let s of this.seekZone())if(s.test(e,t))return!0;return!1}h(e,t,...s){for(let r of this.seekZone())if(r===void 0&&ce(0),r.test(e,t)){let a=s.flat(1).filter(nt);return r.h(e,t,...a)}ce(0,e)}static create(e){let t=new this(e);return{h:t.bindMethod("h"),Fragment:$,setDefaultZone:t.bindMethod("setDefaultZone"),pushZone:t.bindMethod("pushZone"),popZone:t.bindMethod("popZone")}}},at=class extends z{h(e,t,...s){return super.h(e,tt(t),...s)}},A=class{parent;constructor(e){this.parent=e}setStyle(e){let t=this.parent.style;e=F(E(e).filter(([s,r])=>s.startsWith("--")?(r!==void 0&&t.setProperty(s,r),!1):!0)),W(t,e)}clearStyle(){let e=this.parent.style,t=[...e],s=F(t.filter(r=>r.startsWith("--")?(e.removeProperty(r),!1):!0).map(r=>[r,""]));W(e,s)}},lt=class{sheet;stylables;style_cls;constructor(e=new CSSStyleSheet,t=A){this.sheet=e,this.style_cls=t;let s=[...e.cssRules].map(r=>[r.selectorText,new t(r)]);this.stylables=new Map(s)}getSheet(){return this.sheet}getRule(e){return this.stylables.get(e)}setRule(e,t={}){let s=this.getRule(e);if(!s){let r=this.sheet,a=this.style_cls;r.replaceSync(e+` { }
`),s=new a([...r.cssRules].find(o=>o.selectorText===e)),this.stylables.set(e,s)}return s.setStyle(t),s}delRule(e){let t=this.stylables;return t.get(e)?.clearStyle(),t.delete(e)}renameSelector(e,t){let s=this.stylables,r=s.get(e);if(r)return r.parent.selectorText=t,s.delete(e),s.set(t,r),r}},ve=e=>e==null,ot=e=>e===!0||e===!1,ee=e=>ve(e)?null:e.toString(),Se=e=>ot(e)?e?"":null:ee(e),it=e=>document.createElement(e.tag),Ee=e=>document.createElementNS("http://www.w3.org/2000/svg",e.tag),we=e=>[],V=class extends be{test(e,t){return w(e)}h(e,t,...s){let{[x]:r={},[M]:a={},[C]:o={},[q]:i,[N]:d,[j]:u,...h}=t??{};s=s.map(m=>this.processChild(m));let c=e(h);if(_e(c))return c.push(...s),c;for(let[m,y]of E(r))this.addAttr(c,m,y);for(let[m,y]of E(a)){let[b,L]=_e(y)?y:[y];this.addEvent(c,m,b,L)}for(let[m,y]of E(o))this.setMember(c,m,y);return i&&this.setStyle(c,i),d&&this.runOnInit(c,d),c.append(...s),c}addAttr(e,t,s){let r=t instanceof Attr,a=Se(s),o=ve(a),i=r?t:(e.setAttribute(t,a??""),e.getAttributeNode(t));return r&&!o&&(i.nodeValue=a,e.setAttributeNode(i)),o&&(e.removeAttributeNode(i),i.nodeValue=a),i}addEvent(e,t,s,r){e.addEventListener(t,s,r)}setMember(e,t,s){e[t]=s}setStyle(e,t){let s=new A(e);return s.setStyle(t),s}runOnInit(e,t){t(e)}runOnClean(e,t){t(e)}processChild(e){return e}},_t=class extends V{test(e,t){return typeof e=="string"}h(e,t,...s){return super.h(Ee,{tag:e,...Q(t)},...s)}},ct=class extends V{test(e,t){return e==="template"}h(e,t,...s){let{id:r,is:a,shallow:o=!1,sheets:i=[]}=t,d=document.createElement("template"),u=d.content,h=class extends HTMLElement{constructor(){super();let c=this.attachShadow({mode:"open"});c.adoptedStyleSheets.push(...i),c.appendChild(u.cloneNode(!o))}};return et.define(r,h,{extends:a}),super.h(()=>u,{},...s),d}},dt=class extends V{test(e,t){return e===$}h(e,t,...s){return super.h(we,{},...s)}},ut=class extends A{createEffect;constructor(e,t){super(t),this.createEffect=e}setStyle(e){let t=this.parent.style,s=this.createEffect;e=F(E(e).filter(([r,a])=>w(a)?(s(o=>{t.setProperty(r,a(o)??null)},{defer:!1}),!1):!0)),super.setStyle(e)}},pt=w,ht=w,gt=w,D=class extends V{ctx;createEffect;constructor(e){super();let t=e instanceof z,s=(t?e.configs.tsignal?.ctx:e?.ctx)??new ye;e instanceof z&&((e.configs.tsignal??={}).ctx=s),this.createEffect=s.addClass($e),this.ctx=s}addAttr(e,t,s){let r=pt(s),a=r?s():s,o=super.addAttr(e,t,a);return r&&this.createEffect(i=>{let d=o.nodeValue,u=Se(s(i)),h=u!==d;return(h||i)&&(u?d||(o.nodeValue=u,e.setAttributeNode(o)):(o.ownerElement??e).removeAttributeNode(o),o.nodeValue=u),!h},{defer:!1}),o}setMember(e,t,s){let r=gt(s),a=r?s():s;super.setMember(e,t,a),r&&this.createEffect(o=>{let i=e[t],d=s(o),u=d!==i;return(u||o)&&(e[t]=d),!u},{defer:!1})}setStyle(e,t){let s=w(t),r=s?new A(e):new ut(this.createEffect,e);return s?this.createEffect(a=>{r.setStyle(t(a))},{defer:!1}):r.setStyle(t),r}processChild(e){if(ht(e)){let t=document.createTextNode("");return this.createEffect(s=>{let r=t.nodeValue,a=e(s);return t.nodeValue=ee(a),a===r},{defer:!1}),t}return e instanceof Node?e:ee(e)??""}},ft=class extends D{test(e,t){return typeof e=="string"}h(e,t,...s){return super.h(it,{tag:e,...Q(t)},...s)}},mt=class extends D{test(e,t){return typeof e=="string"}h(e,t,...s){return super.h(Ee,{tag:e,...Q(t)},...s)}},yt=class extends D{test(e,t){return e===$}h(e,t,...s){return super.h(we,{},...s)}};export{x as ATTRS,ye as Context,A as DynamicStylable,lt as DynamicStyleSheet,M as EVENTS,z as HyperZone,at as InlineHyperZone,C as MEMBERS,Qe as MemoSignal_Factory,N as ONINIT,Ke as StateSignal_Factory,D as TsignalComponentRender,yt as TsignalFragmentRender,ft as TsignalHTMLRender,mt as TsignalSVGRender,V as VanillaComponentRender,dt as VanillaFragmentRender,_t as VanillaSVGElementRender,ct as VanillaTemplateRender,E as object_entries,Xe as throttlingEquals};
